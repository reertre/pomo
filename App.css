#!/usr/bin/env bash

# --- CONFIGURATION ---
RELEASE_VERSION="3.0"
CHG="CHG181272245"

# If you need to replace some old values:
OLD_CHG="CHG123456789"
OLD_RELEASE="1.0"

# Make sure the required variables are set
if [ -z "$CHG" ] || [ -z "$RELEASE_VERSION" ]; then
  echo "ERROR! Both CHG and RELEASE_VERSION must be defined."
  exit 1
fi

# --- RENAMING LOGIC ---
# Depth-first rename of anything containing OLD_CHG --> CHG
echo "Renaming items containing '$OLD_CHG' to '$CHG' (bottom-up)..."
find . -depth -name "*${OLD_CHG}*" -exec bash -c '
  for f in "$@"; do
    new="${f//$OLD_CHG/$CHG}"
    mv "$f" "$new"
  done
' _ {} +

# Depth-first rename of anything containing OLD_RELEASE --> RELEASE_VERSION
echo "Renaming items containing '$OLD_RELEASE' to '$RELEASE_VERSION' (bottom-up)..."
find . -depth -name "*${OLD_RELEASE}*" -exec bash -c '
  for f in "$@"; do
    new="${f//$OLD_RELEASE/$RELEASE_VERSION}"
    mv "$f" "$new"
  done
' _ {} +

echo "Renaming complete."